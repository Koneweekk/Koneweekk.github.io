---
title: JAVA - 네트워크
date: 2024-05-20 15:00:00 +09:00
categories: [Programming Language, Java]
tags:
  [
    프로그래밍 언어,
    Java,
    크롤링
  ]
---

## Ⅰ. URL을 통한 크롤링

자바코드로 url을 통해 직접 자원을 가져오는 방법은 다음과 같다.

```java
String urlStr = "https://i.namu.wiki/i/tK2l6yUZ0GV0Nlwfe6OEYfX66XaWrxBVbCwvQCI-y_P56zk3m2Djb-wN49PTQ_o1oXVtV_nYBoNY-f1t3NNVYg.webp";

//URL 객체를 생성
URL url = new URL(urlStr);
// url.openStream()을 호출하여 URL에 연결하고, 데이터를 읽기 위해 BufferedInputStream 객체를 생성
BufferedInputStream bis = new BufferedInputStream(url.openStream());

// URLConnection 연결된 주소에서 원하는 값을 추출
URLConnection uc = url.openConnection();

System.out.println("파일 크기 : " + uc.getContentLength());
System.out.println("파일 형식 : " + uc.getContentType());

// 로컬 파일을 생성하고, 데이터를 기록하기 위해 FileOutputStream 객체를 생성
FileOutputStream fos = new FileOutputStream("copy.webp");

// 데이터를 읽고 저장할 버퍼를 생성
byte[] buffer = new byte[2048];
int n = 0;
int count = 0;

// 입력 스트림으로부터 데이터를 반복적으로 읽어옴
while ((n = bis.read(buffer)) != -1) {
  fos.write(buffer, 0, n);
  fos.flush();
  System.out.println("n : " + n);
  count++;
}

System.out.println("count : " + count);
```

---
<br>


## Ⅱ. 소켓 프로그래밍

### 1. 소켓 프로그래밍이란?

> 네트워크를 통해 통신하는 소프트웨어를 작성하는 프로세스

- 소켓은 네트워크 상의 두 노드 간의 통신의 종단점
- 프로토콜, IP 주소, 포트 번호 등을 포함하여 통신을 설정하고 관리
- 소켓 프로그래밍을 통해 컴퓨터 프로그램들은 네트워크를 통해 데이터를 주고받을 수 있음

---

### 2. TCP와 UDP

|특징|TCP|UDP|
|---|---|---|
|연결 방식|연결 지향 (Connection-oriented)|	비연결 지향 (Connectionless)
|신뢰성|높음 (재전송, 순서 보장)|낮음 (손실, 순서 보장 안 됨)|
|오버헤드|큼|작음|
|속도|상대적으로 느림|빠름|
|흐름/혼잡 제어|있음|없음|
|사용 사례|웹 브라우징, 이메일, 파일 전송|스트리밍, 온라인 게임, VoIP|

- TCP는 신뢰성과 데이터의 순서가 중요한 애플리케이션에서 사용
- UDP는 속도와 효율성이 중요한 실시간 애플리케이션에서 사용

---

### 3. 서버 소켓

- 여러 클라이언트 소켓의 연결 요청을 대기
- 각 클라이언트 소켓과 통신을 처리
- 연결된 클라이언트 소켓과의 통신을 담당하는 소켓을 각각 서버에 생성
  
---

### 4. 예시 코드

서버 소켓

```java
// 서버 소켓 생성
ServerSocket serversocket = new ServerSocket(9999);
System.out.println("접속 대기 중 ....");

// 클라이언트 소켓과 연결 생성
Socket socket =  serversocket.accept();
System.out.println("연결 완료");

// 연결된 클라이언트 소켓에 메시지 전송
OutputStream out = socket.getOutputStream();
DataOutputStream dos = new DataOutputStream(out);
dos.writeUTF("통신 시작합니다 ....");

// 서버 소켓 종료
System.out.println("서버 종료");

dos.close();
out.close();
socket.close();
```

클라이언트 소켓

```java
// 클라이언트 소켓 생성
Socket socket = new Socket("ip주소", 9999);
System.out.println("서버와 연결되었습니다.");

// 서버에서 보낸 메시지 받기
InputStream in = socket.getInputStream();
DataInputStream dis = new DataInputStream(in);
String serverMsg = dis.readUTF();
System.out.println("서버에서 보낸 메시지 : " + serverMsg);

// 클라이언트 소켓 종료
dis.close();
in.close();
socket.close();
```


