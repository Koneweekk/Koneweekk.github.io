---
title: DATABASE - SQL 기본 문법(Oracle DB)
date: 2024-03-29 11:50:00 +09:00
categories: [DB, sql]
tags:
  [
    Data,
    DB,
    Datebase,
    oracle,
    sql,
  ]
---

## 1. SELECT

### 전체 컬럼 조회

`*` : All의 의미를 지니고 있음

```sql
SELECT * FROM emp;

/*
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7499	ALLEN	SALESMAN	7698	1981-02-20 00:00:00	1600	300	30
7521	WARD	SALESMAN	7698	1981-02-22 00:00:00	1250	200	30
7566	JONES	MANAGER	7839	1981-04-02 00:00:00	2975	30	20
7654	MARTIN	SALESMAN	7698	1981-09-28 00:00:00	1250	300	30
7698	BLAKE	MANAGER	7839	1981-04-01 00:00:00	2850		30
7782	CLARK	MANAGER	7839	1981-06-01 00:00:00	2450		10
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7839	KING	PRESIDENT		1981-11-17 00:00:00	5000	3500	10
7844	TURNER	SALESMAN	7698	1981-09-08 00:00:00	1500	0	30
7876	ADAMS	CLERK	7788	1983-01-12 00:00:00	1100		20
7900	JAMES	CLERK	7698	1981-10-03 00:00:00	950		30
7902	FORD	ANALYST	7566	1981-10-03 00:00:00	3000		20
7934	MILLER	CLERK	7782	1982-01-23 00:00:00	1300		10
*/
```

### 부분 컬럼 조회

조회하고 싶은 칼럼만 지정 가능

```sql
SELECT empno, ename, sal FROM emp;

/*
7788	SCOTT	3000
7499	ALLEN	1600
7521	WARD	1250
7566	JONES	2975
7654	MARTIN	1250
7698	BLAKE	2850
7782	CLARK	2450
7788	SCOTT	3000
7839	KING	5000
7844	TURNER	1500
7876	ADAMS	1100
7900	JAMES	950
7902	FORD	3000
7934	MILLER	1300
*/
```

<hr>

## 2. ALIAS

칼럼명에 별칭 붙이기

### 기본 사용법

```sql
SELECT ename 사번, ename 이름 FROM emp;
```

### 띄워쓰기 사용 가능

띄워쓰기가 있는 문자열을 별칭으로 쓸 땐 따옴표를 붙여야함

```sql
SELECT ename "사 번", ename "이 름" FROM emp;
```

### 표준 문법에서의 사용

SQL 표준 문법(ANSI) : Oracle, Mssql, mysql 동일한 query 사용 가능
- `as`를 통해 ALIAS 지정

```sql
SELECT ename AS "사 번", ename AS "이 름" FROM emp;
```

<hr>

## 3. WHERE

조건에 따라 데이터 가져옴

### 사용법

`WHERE` 뒤로 조건문을 입력

```sql
SELECT * FROM emp WHERE ename='KING';

-- 7839	KING	PRESIDENT		1981-11-17 00:00:00	5000	3500	10
```

### WHERE문의 실행 순서

1. `FROM`으로 테이블 선택
2. `WHERE`로 조건에 맞는 행 선택
3. `SELECT`로 선택한 열만 추출

## 4. DESC

테이블 정보(컬렴명, null 허용, 타입) 추출

```sql
DESC emp;

/*
이름       널?       유형           
-------- -------- ------------ 
EMPNO    NOT NULL NUMBER       
ENAME             VARCHAR2(10) 
JOB               VARCHAR2(9)  
MGR               NUMBER       
HIREDATE          DATE         
SAL               NUMBER       
COMM              NUMBER       
DEPTNO            NUMBER  
*/
```

<hr>

## 5. DISTINCT

중복행 제거 : 같은 이름끼리 grouping 후 하나의 데이터만 내보냄

```sql
SELECT DISTINCT job FROM emp;

/*
SALESMAN
CLERK
PRESIDENT
MANAGER
ANALYST
*/
```

<hr>

## 6. 연산자

### 문자열 결합 연산자

Oracle에선 문자열 결합 연산자로 `||`를 사용한다.
- MySql은 `+`

```sql
SELECT '사원의 이름은 ' || ename || ' 입니다.' AS "사원이름" FROM emp;

/*
사원의 이름은 SCOTT 입니다.
사원의 이름은 ALLEN 입니다.
사원의 이름은 WARD 입니다.
사원의 이름은 JONES 입니다.
사원의 이름은 MARTIN 입니다.
사원의 이름은 BLAKE 입니다.
사원의 이름은 CLARK 입니다.
사원의 이름은 SCOTT 입니다.
사원의 이름은 KING 입니다.
사원의 이름은 TURNER 입니다.
사원의 이름은 ADAMS 입니다.
사원의 이름은 JAMES 입니다.
사원의 이름은 FORD 입니다.
사원의 이름은 MILLER 입니다.
*/
```

### 나머지 연산자

Oracle에선 나머지 연산자로 `mod()`라는 함수 사용

### 비교 연산자

- `<`, `>` : 대소 비교
- `=`, `!=` : 일치 판단
- `<=`, `>=` : 이상, 이하
  
### 논리 연산자

- `AND` : 논리곱
- `OR` : 논리합
- `NOT` : 부정

### 자동 형변환

자동 형변환도 가능하다.

```sql
SELECT 100 + 100 FROM dual;  -- 200
SELECT 100 || 100 FROM dual;  -- 100100
SELECT '100' + 100 FROM dual;  -- 200
SELECT 'A100' + 100 FROM dual;  -- ORA-01722: invalid number
```

<hr>

## 7. 환경 설정

### 환경 설정 조회

```sql
SELECT * FROM nls_session_parameters;

/*
NLS_LANGUAGE	KOREAN
NLS_TERRITORY	KOREA
NLS_CURRENCY	￦
NLS_ISO_CURRENCY	KOREA
NLS_NUMERIC_CHARACTERS	.,
NLS_CALENDAR	GREGORIAN
NLS_DATE_FORMAT	RR/MM/DD
NLS_DATE_LANGUAGE	KOREAN
NLS_SORT	BINARY
NLS_TIME_FORMAT	HH24:MI:SSXFF
NLS_TIMESTAMP_FORMAT	RR/MM/DD HH24:MI:SSXFF
NLS_TIME_TZ_FORMAT	HH24:MI:SSXFF TZR
NLS_TIMESTAMP_TZ_FORMAT	RR/MM/DD HH24:MI:SSXFF TZR
NLS_DUAL_CURRENCY	￦
NLS_COMP	BINARY
NLS_LENGTH_SEMANTICS	BYTE
NLS_NCHAR_CONV_EXCP	FALSE
*/
```

### 날짜 형식 변경

현재 서버의 날짜 추출

```sql
SELECT SYSDATE FROM dual;
--- 24/03/29
```

날짜 형식 변경 가능
```sql
ALTER SESSION SET nls_date_format = 'YYYY-MM-DD HH24:MI:SS';

SELECT SYSDATE FROM dual;
--- 2024-03-29 14:47:43
```

<hr>

## 8. 비교 축약

### BETWEEN

A 이상 B 이하와 같은 조건은 `between`으로 대체 가능
- 이상, 이하임을 주의하자

```sql
SELECT * FROM emp WHERE sal BETWEEN 2000 AND 4000;

/*
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7566	JONES	MANAGER	7839	1981-04-02 00:00:00	2975	30	20
7698	BLAKE	MANAGER	7839	1981-04-01 00:00:00	2850		30
7782	CLARK	MANAGER	7839	1981-06-01 00:00:00	2450		10
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7902	FORD	ANALYST	7566	1981-10-03 00:00:00	3000		20
*/
```

### IN

하나의 칼럼에 `OR` 조건이 여러 개 걸려 있다면 `IN`으로 대체 가능

```sql
SELECT empno, ename, sal, deptno FROM emp WHERE deptno IN (10,20,30);

/*
7788	SCOTT	3000	20
7499	ALLEN	1600	30
7521	WARD	1250	30
7566	JONES	2975	20
7654	MARTIN	1250	30
7698	BLAKE	2850	30
7782	CLARK	2450	10
7788	SCOTT	3000	20
7839	KING	5000	10
7844	TURNER	1500	30
7876	ADAMS	1100	20
7900	JAMES	950	30
7902	FORD	3000	20
7934	MILLER	1300	10
*/
```

`NOT IN`은 부정의 AND와 똑같은 의미

<hr>

## 9. NULL

값이 없다는 것을 의미

```sql
CREATE TABLE member(
  userid VARCHAR2(20) NOT NULL,  --필수입력사항
  NAME VARCHAR2(20) NOT NULL, --필수입력사항
  hobby VARCHAR2(50) --default null 허용 : 선택입력
)


INSERT INTO MEMBER(userid, name) VALUES('kglim', '길동');
-- hobby에는 자동으로 NULL이 들어감

SELECT * FROM MEMBER;
-- kglim	길동	
```

### IS NULL

속성이 NULL이면 참
- 반대는 `IS NOT NULL`

```sql
SELECT * FROM EMP WHERE comm IS NULL;

/*
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7698	BLAKE	MANAGER	7839	1981-04-01 00:00:00	2850		30
7782	CLARK	MANAGER	7839	1981-06-01 00:00:00	2450		10
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7876	ADAMS	CLERK	7788	1983-01-12 00:00:00	1100		20
7900	JAMES	CLERK	7698	1981-10-03 00:00:00	950		30
7902	FORD	ANALYST	7566	1981-10-03 00:00:00	3000		20
7934	MILLER	CLERK	7782	1982-01-23 00:00:00	1300		10
*/
```

### nv1()

`NULL`과의 모든 연산 결과는 `NULL`
- `nvl()` 함수를 통해 `NULL`을 치환시켜주어야함
- `nvl(컬럼명, NULL을 치환할 값)` 형식으로 사용
- MySQL은 `IFNULL()` 함수를 사용

```sql
SELECT empno, ename, sal, comm, sal + nvl(comm, 0) AS "총급여" FROM EMP;

/*
7788	SCOTT	3000		3000
7499	ALLEN	1600	300	1900
7521	WARD	1250	200	1450
7566	JONES	2975	30	3005
7654	MARTIN	1250	300	1550
7698	BLAKE	2850		2850
7782	CLARK	2450		2450
7788	SCOTT	3000		3000
7839	KING	5000	3500	8500
7844	TURNER	1500	0	1500
7876	ADAMS	1100		1100
7900	JAMES	950		950
7902	FORD	3000		3000
7934	MILLER	1300		1300
*/
```

<hr>

## 10. 문자열 검색

`LIKE` : 문자열 패턴 검색

### 와일드 카드 문자

- `%` : 모든 것
- `_` : 한 문자

```sql

-- A가 들어있는 이름 추출
SELECT * FROM EMP WHERE ename LIKE '%A%';

-- A로 시작하는 이름 추출
SELECT * FROM EMP WHERE ename LIKE 'A%';

-- A로 끝나는 이를 추출
SELECT * FROM EMP WHERE ename LIKE '%A';

-- 연속되는 A가 존재하는 이름
SELECT * FROM EMP WHERE ename LIKE '%AA%';

-- A가 2개 있는 이름
SELECT * FROM EMP WHERE ename LIKE '%A%A%';

-- 2번째가 A인 이름
SELECT * FROM EMP WHERE ename LIKE '_A%';

```

### 정규 표현식

정규 표현식을 통한 검색 또한 가능
- `regexp_like(컬렴명, 정규표현식)`

<hr>

## 11. ORDER BY

데이터를 정렬하는 역할
- 문자, 숫자, 날짜 가능

### ASC

오름차순으로 정렬(default 설정)

```sql
SELECT * FROM EMP ORDER BY sal;

/*                      
7900	JAMES	CLERK	7698	1981-10-03 00:00:00	950		30
7876	ADAMS	CLERK	7788	1983-01-12 00:00:00	1100		20
7521	WARD	SALESMAN	7698	1981-02-22 00:00:00	1250	200	30
7654	MARTIN	SALESMAN	7698	1981-09-28 00:00:00	1250	300	30
7934	MILLER	CLERK	7782	1982-01-23 00:00:00	1300		10
7844	TURNER	SALESMAN	7698	1981-09-08 00:00:00	1500	0	30
7499	ALLEN	SALESMAN	7698	1981-02-20 00:00:00	1600	300	30
7782	CLARK	MANAGER	7839	1981-06-01 00:00:00	2450		10
7698	BLAKE	MANAGER	7839	1981-04-01 00:00:00	2850		30
7566	JONES	MANAGER	7839	1981-04-02 00:00:00	2975	30	20
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7902	FORD	ANALYST	7566	1981-10-03 00:00:00	3000		20
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7839	KING	PRESIDENT		1981-11-17 00:00:00	5000	3500	10
*/
```

### DESC

내림차순으로 정렬

```sql
SELECT * FROM EMP ORDER BY sal DESC;

/*
7839	KING	PRESIDENT		1981-11-17 00:00:00	5000	3500	10
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7902	FORD	ANALYST	7566	1981-10-03 00:00:00	3000		20
7788	SCOTT	ANALYST	7566	1982-10-09 00:00:00	3000		20
7566	JONES	MANAGER	7839	1981-04-02 00:00:00	2975	30	20
7698	BLAKE	MANAGER	7839	1981-04-01 00:00:00	2850		30
7782	CLARK	MANAGER	7839	1981-06-01 00:00:00	2450		10
7499	ALLEN	SALESMAN	7698	1981-02-20 00:00:00	1600	300	30
7844	TURNER	SALESMAN	7698	1981-09-08 00:00:00	1500	0	30
7934	MILLER	CLERK	7782	1982-01-23 00:00:00	1300		10
7654	MARTIN	SALESMAN	7698	1981-09-28 00:00:00	1250	300	30
7521	WARD	SALESMAN	7698	1981-02-22 00:00:00	1250	200	30
7876	ADAMS	CLERK	7788	1983-01-12 00:00:00	1100		20
7900	JAMES	CLERK	7698	1981-10-03 00:00:00	950		30
*/
```

### ORDER BY의 실행순서

1. `FROM` : 테이블 선택
2. `WHERE` : 조건에 맞는 행만 추출
3. `SELECT` : 추려낸 행에서 선택한 열만 추출
4. `ORDER BY` : 추려낸 행과 열로만 정렬 수행




