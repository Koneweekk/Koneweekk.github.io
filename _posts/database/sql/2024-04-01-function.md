---
title: DATABASE - SQL 함수(Oracle DB)
date: 2024-04-01 09:20:00 +09:00
categories: [DB, sql]
tags:
  [
    Data,
    DB,
    Datebase,
    oracle,
    sql,
  ]
---

## 1. 문자열 함수

### INITCAP

문자열의 첫 글자를 대문자로 바꿈

```sql
SELECT INITCAP('the') FROM dual;
--- The
```

<hr>

### LOWER

문자열의 모든 글자를 소문자로 변경

```sql
SELECT LOWER('ABCDE') FROM dual;
-- abcde

SELECT ename, LOWER(ename) as "lower ename" FROM emp;
/*
SCOTT	scott
ALLEN	allen
WARD	ward
JONES	jones
MARTIN	martin
BLAKE	blake
CLARK	clark
SCOTT	scott
KING	king
TURNER	turner
ADAMS	adams
JAMES	james
FORD	ford
MILLER	miller
*/
```

<hr>

### UPPER

문자열의 모든 글자를 대문자로 변경

```sql
SELECT UPPER('abcde') FROM dual;
--ABCDE
```

<hr>

### LENGTH

문자열의 글자 개수를 반환

```sql
SELECT LENGTH('abcd') FROM dual;
--- 4
```

바이트의 크기가 아닌 글자의 개수이므로 한글이어도 적용 가능

```sql
SELECT LENGTH('홍길동') FROM dual;
--3
```

<hr>

### CONCAT

두 문자열을 하나의 문자열로 합침

```sql
SELECT CONCAT('a','b') FROM dual;
--ab

SELECT CONCAT(ename, job) FROM emp;
/*
SCOTTANALYST
ALLENSALESMAN
WARDSALESMAN
JONESMANAGER
MARTINSALESMAN
BLAKEMANAGER
CLARKMANAGER
SCOTTANALYST
KINGPRESIDENT
TURNERSALESMAN
ADAMSCLERK
JAMESCLERK
FORDANALYST
MILLERCLERK
*/
```

문자열 합산 연산자와 역할이 비슷

```sql
SELECT 'a' || 'b' || 'c' FROM  dual;
--abc
```

<hr>

### SUBSTR

부분문자열을 추출
- `SUBSTR(문자열, 시작 문자열, 추출할 글자 개수)`
- ORACLE SQL에선 문자열 시작 인덱스가 1임을 기억하자

```sql
SELECT substr('ABCDE', 2, 3) FROM dual;
--BCD
```

세 번째 매개변수를 생략하면 시작 인덱스부터 문자열의 끝까지 추출한다.

```sql
SELECT lower(substr(ename,1,1)) || ' ' || substr(ename, 2) FROM emp;

/*
s COTT
a LLEN
w ARD
j ONES
m ARTIN
b LAKE
c LARK
s COTT
k ING
t URNER
a DAMS
j AMES
f ORD
m ILLER
*/
```

<hr>

### LPAD

지정한 글자 수 만큼 왼쪽 문자열을 채움
- `LPAD(표시할 문자열, 총 문자열의 길이, 빈 문자열을 채울 글자)`

```sql
SELECT LPAD('ABC', 10, '*') FROM dual;
-- *******ABC
```

<hr>

### RPAD

지정한 글자 수 만큼 왼쪽 문자열을 채움
- `RPAD(표시할 문자열, 총 문자열의 길이, 빈 문자열을 채울 글자)`

```sql
SELECT RPAD('ABC', 10, '*') FROM dual;
-- ABC*******
```

<hr>

### LTRIM

왼쪽의 지정한 문자열을 삭제
- 중복값도 같이 삭제

```sql
SELECT LTRIM('MILLLLLLLLER', 'MIL') FROM DUAL;
-- ER
```

<hr>

### RTRIM

오른쪽의 지정한 문자열을 삭제

```sql
SELECT RTRIM('MILLER', 'ER') FROM DUAL;
-- MILL
```

<hr>

### REPLACE

문자열에서 지정한 부분에 속해있다면 교체함
- `REPLACE(문자열, 교체할 부분, 대체할 문자열)`

```sql
SELECT ENAME, REPLACE(ename, 'A', '와우') FROM EMP;

/*
SCOTT	SCOTT
ALLEN	와우LLEN
WARD	W와우RD
JONES	JONES
MARTIN	M와우RTIN
BLAKE	BL와우KE
CLARK	CL와우RK
SCOTT	SCOTT
KING	KING
TURNER	TURNER
ADAMS	와우D와우MS
JAMES	J와우MES
FORD	FORD
MILLER	MILLER
*/
```

<hr><br>

## 2. 숫자 함수

### ROUND

반올림 함수
- `ROUND(숫자, 나타낼 자리수)`
- 나타낼 자리수까지 반올림하여 나타냄(0 : 정수부분만 나타냄)
- 두 번째 매개변수의 디폴트값은 0

```sql
SELECT ROUND(12.345) AS r FROM DUAL;
-- 12
SELECT ROUND(12.545) AS r FROM DUAL;
-- 13

SELECT ROUND(12.345, 1) AS r FROM DUAL;
-- 12.3
SELECT ROUND(12.355, 1) AS r FROM DUAL;
-- 12.4

SELECT ROUND(12.345, -1) AS r FROM DUAL;
-- 10
SELECT ROUND(15.355, -1) AS r FROM DUAL;
-- 20
```

<hr>

### TRUNC

절삭 함수
- `TRUNC(숫자, 나타낼 자리수)`
- 나타낼 자리수까지만 잘라서 나타냄(0 : 정수부분만 나타냄)
- 두 번째 매개변수의 디폴트값은 0

```sql
SELECT TRUNC(12.345) AS r FROM DUAL;
-- 12
SELECT TRUNC(12.545) AS r FROM DUAL;
-- 12

SELECT TRUNC(12.345, 1) AS r FROM DUAL;
-- 12.3
SELECT TRUNC(12.355, 1) AS r FROM DUAL;
-- 12.3

SELECT TRUNC(12.345, -1) AS r FROM DUAL;
-- 10
SELECT TRUNC(15.355, -1) AS r FROM DUAL;
-- 10
```

<hr>

### MOD

나머지 함수
- `MOD(분자, 분모)`
- 분자 / 분모의 나머지를 반환

```sql
SELECT MOD(12,10) FROM DUAL;
-- 2

SELECT MOD(0,0) FROM DUAL;
-- 0
```

<hr><br>

## 3. 날짜 함수

### 날짜 연산의 특징

날짜와 날짜 혹은 날짜와 숫자 사이 연산 결과 타입은 다음과 같다.

- Date + number >> Date
- Date - number >> Date
- Date - Date >> number

<hr>

### MONTHS_BETWEEN

두 날짜 사이에 월수를 계산하는 함수
- `MONTHS_BETWEEN(날짜1, 날짜2)`
- 실수로 표현됨 >> `TRUNC` 혹은 `ROUND` 활용

```sql
SELECT ROUND(MONTHS_BETWEEN(sysdate, hiredate)) AS "근속 월수" FROM EMP;

/*
498
517
517
516
510
516
514
498
508
511
495
510
510
506
*/
```

<hr><br>

## 4. 변환 함수

### TO_CHAR

문자열 변환 함수
- 출력 형식을 정의(포매팅)하기 위해 사용 

```sql
SELECT 
sysdate, 
TO_CHAR(sysdate, 'YYYY') || '년' AS yyyy,
TO_CHAR(sysdate, 'YEAR') AS year,
TO_CHAR(sysdate, 'MM') AS mm,
TO_CHAR(sysdate, 'DD') AS dd,
TO_CHAR(sysdate, 'DAY')
FROM DUAL;

-- 2024-04-01 11:50:14	2024년	TWENTY TWENTY-FOUR	04	01	월요일
```

<hr>

### TO_DATE

날짜 형식의 문자열을 날짜 타입으로 변경

```sql
SELECT '2024-01-01' + 100 FROM DUAL;
-- 문자열로 인식하여 오류 발생

SELECT TO_DATE('2024-01-01') + 100 FROM DUAL;
-- 2024-04-10 00:00:00
```

<hr>

### TO_NUMBER

숫자 형식의 문자열을 숫자로
- 자동 형변환때문에 거의 쓰이지 않음

```sql
SELECT '100' + 100 FROM DUAL;
-- 200

SELECT TO_NUMBER('100') + 100 FROM DUAL;
-- 200
```
